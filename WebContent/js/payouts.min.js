function updatePieChart(e){var t=$.get("../app/payouts/get-transaction-pie");t.done(function(t){var a=t,i=[];$.each(a,function(){var e=this.type,t=this.amount;i.push([e,t])});var n=e.highcharts();n.series[0].setData(i,!0)})}function colorizeUnpaidShareCountLabel(e){var t=parseInt(e.html()),a=0/0==t;if(!a)switch(!0){case 100>t:removeClassByWildCard(e,"label-"),e.addClass("label-success");break;case 300>t:removeClassByWildCard(e,"label-"),e.addClass("label-warning");break;default:removeClassByWildCard(e,"label-"),e.addClass("label-danger")}}function initializeTransactionPieChart(e){e.highcharts({chart:{plotBackgroundColor:null,plotBorderWidth:null},title:{text:null},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.y}</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %"}}},series:[{type:"pie",name:"Gold Amount",data:[["Clan Payout",2e3],["Tier X Incentive",200],["Player Bonus",100]]}]})}function initializeTransactionDataTable(e){e.dataTable({paging:!0,pageLength:10,pagingType:"simple",order:[[1,"desc"]],stateSave:!0,searching:!0,columnDefs:[{targets:[0],orderable:!1}],drawCallback:function(e){if(e.bSorted||e.bFiltered)for(var t=0,a=e.aiDisplay.length;a>t;t++)$("td:eq(0)",e.aoData[e.aiDisplay[t]].nTr).html(t+1)}})}$(document).ready(function(){highlightNavButton("#payments");var e=$("#transaction-history-table"),t=$("#transaction-history-highchart"),a=$(".payout-tooltip"),i=e.find(".transaction-payout-time"),n=$(".row-offcanvas"),o=$(".btn-offcanvas"),r=o.find(".fa-offcanvas-arrow"),l=$(".btn-payout"),s=$("#payout-groups-modal"),d=$("#payout-success-modal"),c=$("#unpaid-shares-span"),m=$("#caller-bonus-battle-amount"),u=$("#caller-bonus-unpaid-battles"),f=$("#caller-bonus-total-amount"),p=$(".input-daterange");formatMilisToLocalizedtime(i),initializeTransactionDataTable(e),initializeTransactionBarGraphChart(t),updatePieChart(t);var g={weekStart:0,format:"mm/dd/yyyy",autoclose:!0};p=initializeDateRange(p,g),colorizeUnpaidShareCountLabel(c),a.tooltip(),m.trigger("change"),o.on("click",function(){n.toggleClass("active"),r.toggleClass("fa-arrow-right")}),l.on("click",function(){var e=$(this).closest("form"),t=e.data("form-submit-url"),a=!validateInputs(e);if(!a){var i=$.post(t,e.serialize()),n=$(this).hasClass("btn-payout-standard");i.done(function(e){n?d.modal("show"):(s.find(".modal-body").empty().html(e),s.modal("show"))})}}),s.on("click","#btn-group-payout-finalize",function(){var e=s.find("#new-calculated-payout-group-total-form"),t=e.data("form-submit-url");s.modal("hide");var a=$.post(t,e.serialize());a.done(function(){d.modal("show")})}),s.on("click",".btn-script-generation",function(){var e=$(this),t=e.closest(".panel").find(".panel-body .player-nickname"),a=e.data("gold-amount"),i=[];t.each(function(){i.push($(this).text())});var n="../app/payouts/get-payout-script.user.js?payoutAmount="+a;$.each(i,function(){n+="&playerNicknames="+this}),window.location=n}),p.datepicker().on("changeDate",function(){var e=$("#campaign-start-date").datepicker("getDate"),t=$("#campaign-end-date").datepicker("getDate"),a=e.getTime(),i=t.getTime();$("#hidden-campaign-start-date").val(a),$("#hidden-campaign-end-date").val(i)}),m.on("keyup change",function(){var e=$(this).val(),t=u.text(),a=+e*+t;f.text(a)}),m.change()});