function initializeAttendanceDataTable(e){e.dataTable({paging:!0,pageLength:100,pagingType:"simple",order:[[2,"desc"]],stateSave:!0,searching:!0,columnDefs:[{targets:[0],orderable:!1}],columns:[{"class":"text-center"},{"class":"text-center"},{"class":"text-center"}],drawCallback:function(e){if(e.bSorted||e.bFiltered)for(var t=0,a=e.aiDisplay.length;a>t;t++)$("td:eq(0)",e.aoData[e.aiDisplay[t]].nTr).html(t+1)}})}function initializeDatepicker(e){e.datepicker({weekStart:0,format:"mm/dd/yyyy",daysOfWeekDisabled:"1,2,3,4,5,6",todayHighlight:!0,autoclose:!0});var t=new Date,a=new DateUtil(t).getStartOfWeek();e.datepicker("update",a)}function reinitializeDatepicker(e,t){e.datepicker("remove"),e.find("input").val("");var a="months"==t,i="years"==t,n="mm/dd/yyyy";a&&(n="mm/yyyy"),i&&(n="yyyy"),e.datepicker({minViewMode:t,format:n,weekStart:0,daysOfWeekDisabled:"1,2,3,4,5,6",todayHighlight:!0,autoclose:!0}),e.datepicker("update",new Date)}function submitAttendanceForm(e,t,a){var i=a.data("attendance-form-submit"),n=a.DataTable(),o=$.get(i,{startTime:e,endTime:t});o.done(function(e){n.clear(),$.each(e,function(e,t){var a=t.nickname,i=t.points;n.row.add(["",a,i])}),n.draw()})}$(document).ready(function(){highlightNavButton("#attendance");var e=$("#attendance-history-table"),t=$(".standard-date-picker-container > .input-group.date"),a=$(".date-picker-input"),i=$(".date-radios"),n=$(".submit-attendance-form");initializeDatepicker(t),initializeAttendanceDataTable(e),i.on("change",function(){var e=$(this).val(),a="all"==e;a?(t.datepicker("remove"),t.find("input").val("Birth of Christ")):reinitializeDatepicker(t,e)}),n.on("click",function(){var n=i.filter(":checked").val(),o=a.val(),r=validDateRegex.test(o)||"Birth of Christ"==o;if(r){t.removeClass("has-error");var l,s,d=t.datepicker("getDate");switch(n){case"years":l=new DateUtil(d).getStartOfYear().getTime(),s=new DateUtil(d).getEndOfYear().getTime();break;case"months":l=new DateUtil(d).getStartOfMonth().getTime(),s=new DateUtil(d).getEndOfMonth().getTime();break;case"days":l=new DateUtil(d).getStartOfWeek().getTime(),s=new DateUtil(d).getEndOfWeek().getTime();break;default:t.datepicker("remove"),l=(new DateUtil).getStartOfTime().getTime(),s=(new DateUtil).getToday().getTime()}submitAttendanceForm(l,s,e)}else t.addClass("has-error")})});