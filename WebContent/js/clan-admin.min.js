function setTimeInEventPutForm(e){var t=new Date;t.setTime(e),$(".input-group.date").datepicker("update",t);var a=new DateUtil(t),i=a.getUnitedStatesTime();$("#event-start-time").timepicker("setTime",i)}function getStringDateForTimePicker(){var e=new Date,t=e.getMonth()+1,a=e.getDate(),i=e.getFullYear(),n=(e.getHours(),""+t+"/"+a+"/"+i+" ");return n}$(document).ready(function(){highlightNavButtons(["#admin","#clan-settings"]);var e=$("#admin-large-modal"),t=$("#admin-small-modal"),a=$("#admin-tool-container"),i=e.find(".modal-content"),n=t.find(".modal-content"),o=$(".admin-sidebar-link");a.on("change",".date-radios",function(){var e=$(".standard-date-picker-container > .input-group.date"),t=$(this).val(),a="all"==t;a?(e.datepicker("remove"),e.find("input").val("Birth of Christ")):reinitializeDatepicker(e,t)}),a.on("click","#attendance-timeframe-search",function(){var e=$("#caller-attendance-table"),t=$(".date-radios"),a=$(".standard-date-picker-container > .input-group.date"),i=$(".date-picker-input"),n=t.filter(":checked").val(),o=i.val(),r=validDateRegex.test(o)||"Birth of Christ"==o;if(r){a.removeClass("has-error");var l,s,d=a.datepicker("getDate");switch(n){case"years":l=new DateUtil(d).getStartOfYear().getTime(),s=new DateUtil(d).getEndOfYear().getTime();break;case"months":l=new DateUtil(d).getStartOfMonth().getTime(),s=new DateUtil(d).getEndOfMonth().getTime();break;case"days":l=new DateUtil(d).getStartOfWeek().getTime(),s=new DateUtil(d).getEndOfWeek().getTime();break;default:a.datepicker("remove"),l=(new DateUtil).getStartOfTime().getTime(),s=(new DateUtil).getToday().getTime()}submitAttendanceForm(l,s,e)}else a.addClass("has-error")}),a.on("click",".btn-player-check-in",function(){var e=$(this),t=e.closest("form"),a=!validateInputs(t);if(!a){var i=t.find("#incentive-playername").val(),n=t.find(".input-group.date").datepicker("getDate").getTime(),o=$.post("manual-player-check-in",{accountId:i,checkInTime:n});o.done(function(){var e=t.data("success-text");displayNewAdminToolSuccess(e)})}}),a.on("click",".btn-add-event",function(){var e=$(this),t=e.closest("form"),a=!validateInputs(t)}),a.on("click",".event-crud",function(){var e=$(this),a=e.closest("tr").find(".event-id").text(),i=e.hasClass("edit-event"),o=e.hasClass("delete-event"),r=e.data("ajax-url");if(i){var l=$.get(r,{eventId:a});l.done(function(e){n.empty().html(e),t.modal()})}else if(o){var s=$.get(r,{eventId:a});s.done(function(e){n.empty().html(e),t.modal()})}}),t.on("click",".btn-event-put",function(){var e=$(this),i=e.closest(".modal-content").find("form"),n=(i.data("form-submit-url"),!validateInputs(i));if(!n){var r=i.find("#event-start-date").datepicker("getDate"),l=$("#event-start-time").val(),s=getStringDateForTimePicker(),d=new Date(s+l),c=d.getHours(),m=d.getMinutes(),u=r.setHours(c,m,0,0),f=i.serialize()+"&time="+u,g=$.post("put-event",f);g.done(function(){var t=void 0!=e.data("page-refresh"),n=i.data("success-text");t?reloadCurrentAdminTool(o,a,n):displayNewAdminToolSuccess(n)}).always(function(){t.modal("hide")})}}),a.on("click",".btn-clan-settings-form-submit",function(){var e=$(this),t=$("form"),a=$(".clan-settings-form").serialize(),i=!0;if($.each(t,function(){i=validateInputs(t)}),i){var n,o=$("#clan-war-day-start-time").val(),r=getStringDateForTimePicker(),l=new Date(r+o),s=l.getHours(),d=l.getMinutes(),c=0==d,n=c?0:d/60,m=s>=12,u=s+n,f=m?24-u:-1*u,g=(new Date).getTimezoneOffset(),h=g/60*-1,p="0"==d;n=p?0:d/60*-1;var v=f+h;a+="&battleDayGmtOffset="+v;var y=$.post("put-clan-settings",a);y.done(function(){var t=e.data("success-text");displayNewAdminToolSuccess(t)})}}),a.on("click",".news-crud",function(){var a=$(this),o=a.closest("tr").find(".news-banner-id").text(),r=a.hasClass("edit-clan-news"),l=a.hasClass("copy-clan-news"),s=a.hasClass("delete-clan-news"),d=a.data("ajax-url");if(r||l){var c=$.get(d,{newsCarouselId:o});c.done(function(t){i.empty().html(t),e.modal()})}else if(s){var m=$.get(d,{newsCarouselId:o});m.done(function(e){n.empty().html(e),t.modal()})}})});